DEBUG=0

# Sanity check (Are we where we want to be with the files we expect?)
debug_check_pwd_and_files() {
    if [ $DEBUG -eq 1 ]; then 
        echo "------------- Files in `pwd` and subfolders -------------"
        ls -A *
        echo "---------------------------------------------------------"
    fi
}

module load Python-shared
module load R-3.3.0-sharedlib
module load bowtie2-2.3.2
module load stringtie-1.3.0
module load HISAT2-2.1.0

# Keep track of where we started from
RNASEQ_STARTING_PATH=$PWD

# To PATH, add absolute values for ../../bin and ../../R

cd ../../bin
RNASEQ_BIN_PATH=$PWD
cd $RNASEQ_STARTING_PATH

cd ../../R
RNASEQ_BIN_PATH="$PWD:$RNASEQ_BIN_PATH"
cd $RNASEQ_STARTING_PATH

export PATH="$RNASEQ_BIN_PATH:$PATH"


debug_check_pwd_and_files

echo 'running RNAseq_process_data.sh -e -H 4 -O -C s_?'
#EXPLANATION OF FLAGS USED (listed alphabetically)
# -a use "transcripts.gtf" for gene models and skip preprocessing
# -C leave temporary files on file system
# -e Single-end reads
# -H number of threads to use
# -O preprocess data
# -X Phred quality values encoded as Phred + 33
RNAseq_process_data.sh -e -H 4 -O -C s_?

debug_check_pwd_and_files

echo 'running RNAseq_process_data.sh -e -H 4 -a -X s_?'
RNAseq_process_data.sh -e -H 4 -a -X s_?

debug_check_pwd_and_files

# run ballgown
ballgown_setup.pl --cont "s_[13]" --exp "s_[24]"

debug_check_pwd_and_files

ballgown.Rscript 

debug_check_pwd_and_files
